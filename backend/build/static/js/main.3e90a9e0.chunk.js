(this["webpackJsonpultraotp-client"]=this["webpackJsonpultraotp-client"]||[]).push([[0],{45:function(e,t,a){e.exports=a(83)},50:function(e,t,a){},51:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(37),o=a.n(c),l=(a(50),a(5)),s=a(15),i=(a(51),a(3)),u=a.n(i),m=a(10),p=a(2),d=a(9),f=a.n(d),h={zIndex:10,position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.7)"},v={zIndex:11,position:"fixed",top:0,left:0,width:"100vw",height:"100vh",display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center"},g={zIndex:12,width:"calc(96% - 40px)",maxWidth:"460px",padding:"10px 20px",borderRadius:"10px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},E={width:"100%",display:"flex",justifyContent:"flex-end"},b=function(e){var t=e.message;return r.a.createElement("div",{className:"Alert",style:t.length>0?{display:"block"}:{display:"none"}},r.a.createElement("div",{style:h}),r.a.createElement("div",{style:v},r.a.createElement("div",{style:g,className:"alertBox"},r.a.createElement("h2",null,"Message"),r.a.createElement("p",null,t),r.a.createElement("div",{style:E},r.a.createElement("button",{onClick:function(){return e.close()},className:"primaryBtn alertBtn"},"Ok")))))};function y(e){var t=new TextEncoder;return window.crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"])}function w(e,t){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}var x=function(e,t){var a,n,r;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,u.a.awrap(y(e));case 2:return a=c.sent,c.next=5,u.a.awrap(w(a,t));case 5:return n=c.sent,c.next=8,u.a.awrap(window.crypto.subtle.exportKey("jwk",n));case 8:return r=c.sent,c.abrupt("return",r);case 10:case"end":return c.stop()}}))};var O=function(e){var t=localStorage.getItem("Jwt"),a=localStorage.getItem("cryptoKey"),c=Object(n.useState)(""),o=Object(p.a)(c,2),i=o[0],d=o[1],h=Object(n.useState)(""),v=Object(p.a)(h,2),g=v[0],E=v[1],y=Object(n.useState)(!1),w=Object(p.a)(y,2),O=w[0],S=w[1],k=Object(n.useState)(""),j=Object(p.a)(k,2),N=j[0],C=j[1];return O||t&&a?r.a.createElement(s.a,{push:!0,to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:N,close:function(){return C("")}}),r.a.createElement("header",{className:"homeHeader"},r.a.createElement("div",{className:"homeTitles"},r.a.createElement("h1",null,"Login")),r.a.createElement("nav",{className:"homeLinksWrapper"},r.a.createElement(l.b,{to:"/",className:"primaryBtn alertBtn cancelBtn btnFlex"},"Back"))),r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{type:"text",id:"username",name:"username",value:i,autoComplete:"username",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",name:"password",value:g,autoComplete:"current-password",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return E(e.target.value)}})),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(e){return function(e){var t;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),a.next=3,u.a.awrap(x(g.concat(i),Uint8Array.from(Object(m.a)(i).map((function(e){return e.charCodeAt()})))));case 3:t=a.sent,f.a.post("https://ultraotp.com/api/user/login",{username:i,password:t.k}).then((function(e){var t;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.data.success){a.next=9;break}return a.next=3,u.a.awrap(x(g,Uint8Array.from(Object(m.a)(e.data.salt).map((function(e){return e.charCodeAt()})))));case 3:t=a.sent,localStorage.setItem("cryptoKey",JSON.stringify(t)),localStorage.setItem("JWT",e.data.JWT),S(!0),a.next=10;break;case 9:C(e.data.message);case 10:case"end":return a.stop()}}))}));case 5:case"end":return a.stop()}}))}(e)},value:"Sign In"})))};var S=function(e){var t=localStorage.getItem("JWT"),a=localStorage.getItem("cryptoKey"),c=Object(n.useState)(!1),o=Object(p.a)(c,2),i=o[0],d=o[1],h=Object(n.useState)(""),v=Object(p.a)(h,2),g=v[0],E=v[1],y=Object(n.useState)(""),w=Object(p.a)(y,2),O=w[0],S=w[1],k=Object(n.useState)(""),j=Object(p.a)(k,2),N=j[0],C=j[1],T=Object(n.useState)(!1),I=Object(p.a)(T,2),A=I[0],P=I[1],W=Object(n.useState)(""),B=Object(p.a)(W,2),F=B[0],H=B[1];return A||t&&a?r.a.createElement(s.a,{push:!0,to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:F,close:function(){return H("")}}),r.a.createElement("header",{className:"homeHeader"},r.a.createElement("div",{className:"homeTitles"},r.a.createElement("h1",null,"Register")),r.a.createElement("nav",{className:"homeLinksWrapper"},r.a.createElement(l.b,{to:"/",className:"primaryBtn alertBtn cancelBtn btnFlex"},"Back"))),r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"username"},"Create a Username ",r.a.createElement("span",null,"(4 - 120 chars.)")),r.a.createElement("input",{type:"text",id:"username",name:"username",value:g,autoComplete:"username",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"password"},"Master Password ",r.a.createElement("span",null,"(12 - 120 chars.)")),r.a.createElement("input",{type:i?"text":"password",id:"password",name:"password",value:O,autoComplete:"new-password",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return S(e.target.value)}}),r.a.createElement("small",null,"The master password is used to encrypt and access your tokens. It is critical that you do not forget your master password; there is no way to recover the password in the event that you forget it.")),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"passwordConf"},"Re-type Master Password ",r.a.createElement("span",null,"(12 - 120 chars.)")),r.a.createElement("input",{type:i?"text":"password",id:"passwordConf",name:"passwordConf",value:N,autoComplete:"new-password",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return C(e.target.value)}}),r.a.createElement("div",{className:"checkContainer"},r.a.createElement("input",{type:"checkbox",id:"passCheck",name:"passCheck",onChange:function(){return d(!i)}}),r.a.createElement("label",{htmlFor:"passCheck"},"Show Password"))),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(e){return function(e){var t,a;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),O!==g){n.next=5;break}H("Username and password must not match. Please update and try again."),n.next=20;break;case 5:if(O===N){n.next=9;break}H("Master password confirmation must match. Please update and try again."),n.next=20;break;case 9:if(!(O.length<12)){n.next=13;break}H("Master password must contain at least 12 characters."),n.next=20;break;case 13:return n.next=15,u.a.awrap(window.crypto.getRandomValues(new Uint8Array(16)));case 15:return t=n.sent,n.next=18,u.a.awrap(x(O.concat(g),Uint8Array.from(Object(m.a)(g).map((function(e){return e.charCodeAt()})))));case 18:a=n.sent,f.a.post("https://ultraotp.com/api/user/register",{username:g,password:a.k,salt:String.fromCharCode.apply(String,Object(m.a)(new Uint8Array(t)))}).then((function(e){var a,n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.data.success){r.next=9;break}return r.next=3,u.a.awrap(x(O,t));case 3:a=r.sent,localStorage.setItem("cryptoKey",JSON.stringify(a)),localStorage.setItem("JWT",e.data.JWT),P(!0),r.next=10;break;case 9:e.data.info?(n=e.data.info.u.message+"\n"+e.data.info.p.message,H(n)):H(e.data.message);case 10:case"end":return r.stop()}}))}));case 20:case"end":return n.stop()}}))}(e)},value:"Register"})))},k=a(39),j=a.n(k),N=a(20),C=a.n(N);var T=function(e){var t;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=window.crypto.subtle.importKey("jwk",e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),a.abrupt("return",t);case 2:case"end":return a.stop()}}))},I=new TextEncoder;var A=function(e,t){var a,n,r,c,o,l;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.a.awrap(T(e));case 2:return a=s.sent,n=window.crypto.getRandomValues(new Uint8Array(12)),r=I.encode(t),s.next=7,u.a.awrap(window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},a,r));case 7:return c=s.sent,o=String.fromCharCode.apply(String,Object(m.a)(new Uint8Array(c))),l=String.fromCharCode.apply(String,Object(m.a)(new Uint8Array(n))),s.abrupt("return",{text:o,iv:l});case 11:case"end":return s.stop()}}))};function P(e){var t=Object(n.useState)(!1),a=Object(p.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),s=Object(p.a)(l,2),i=s[0],u=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"issuer"},"Issuer"),r.a.createElement("input",{type:"text",id:"issuer",name:"issuer",value:e.issuer,autoComplete:"off",required:!0,className:"primaryInput",onChange:function(t){return e.setIssuer(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"name"},"Label"),r.a.createElement("input",{type:"text",id:"name",name:"name",value:e.name,autoComplete:"off",className:"primaryInput",onChange:function(t){return e.setName(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"name"},"Secret"),r.a.createElement("input",{type:c?"text":"password",id:"secret",name:"secret",value:e.secret,autoComplete:"new-password",required:!0,className:"primaryInput",onChange:function(t){return e.setSecret(t.target.value)}}),r.a.createElement("div",{className:"checkContainer"},r.a.createElement("input",{type:"checkbox",id:"secCheck",name:"secCheck",onChange:function(){return o(!c)}}),r.a.createElement("label",{htmlFor:"secCheck"},"Show Secret"))),r.a.createElement("div",{style:i?{display:"flex"}:{display:"none"},className:"advContainer"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"type"},"Type"),r.a.createElement("select",{id:"type",name:"type",className:"primarySelect",onChange:function(t){return e.setType(t.target.value)},value:e.type},r.a.createElement("option",{value:"totp"},"TOTP"),r.a.createElement("option",{value:"hotp"},"HOTP"))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"period"},"hotp"===e.type?"Counter":"Period (in seconds)"," "),r.a.createElement("input",{type:"text",id:"period",name:"period",value:e.period,autoComplete:"off",className:"primaryInput",onChange:function(t){return e.setPeriod(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"digits"},"Digits"),r.a.createElement("select",{id:"digits",name:"digits",className:"primarySelect",onChange:function(t){return e.setDigits(t.target.value)},value:e.digits},r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"8"},"8"))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"algo"},"Algorithm"),r.a.createElement("select",{id:"algo",name:"algo",className:"primarySelect",onChange:function(t){return e.setAlgo(t.target.value)},value:e.algo},r.a.createElement("option",{value:"SHA1"},"SHA1"),r.a.createElement("option",{value:"SHA256"},"SHA256"),r.a.createElement("option",{value:"SHA512"},"SHA512")))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("button",{onClick:function(e){return function(e){e.preventDefault(),u(!i)}(e)},className:"advBtn"},i?"Hide":"More Options")),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(t){return e.submit(t)},value:"Submit"})))}var W=function(){var e=Object(n.useState)("totp"),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),l=Object(p.a)(o,2),i=l[0],m=l[1],d=Object(n.useState)(""),h=Object(p.a)(d,2),v=h[0],g=h[1],E=Object(n.useState)("SHA1"),y=Object(p.a)(E,2),w=y[0],x=y[1],O=Object(n.useState)(6),S=Object(p.a)(O,2),k=S[0],N=S[1],T=Object(n.useState)(30),I=Object(p.a)(T,2),W=I[0],B=I[1],F=Object(n.useState)(""),H=Object(p.a)(F,2),J=H[0],U=H[1],L=Object(n.useState)("Scanning..."),M=Object(p.a)(L,2),z=M[0],K=M[1],R=Object(n.useState)(null),D=Object(p.a)(R,2),G=D[0],V=D[1],q=Object(n.useState)(null),_=Object(p.a)(q,2),Z=_[0],Y=_[1],Q=Object(n.useState)(""),$=Object(p.a)(Q,2),X=$[0],ee=$[1];return Object(n.useEffect)((function(){var e=localStorage.getItem("JWT"),t=localStorage.getItem("cryptoKey");e&&t?navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return Y(!0)})).catch((function(){Y(!1)})):(localStorage.removeItem("JWT"),localStorage.removeItem("cryptoKey"),V("/"))}),[]),G?r.a.createElement(s.a,{push:!0,to:"".concat(G)}):r.a.createElement("div",null,r.a.createElement(b,{close:function(){return ee("")},message:X}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Add New Token"),r.a.createElement("button",{className:"primaryBtn redirectBtn alertBtn cancelBtn",onClick:function(){return V("list")}},"Cancel")),Z&&r.a.createElement("div",{className:"camWrapper"},r.a.createElement(j.a,{delay:500,facingMode:"environment",showViewFinder:!0,onError:function(){K("Camera access must be enabled to scan QR codes.")},onScan:function(e){return function(e){if(null!==e&&e.length>14){var t=e.slice(10,14);if("totp"===t||"hotp"===t){var a=e.match(/(secret=).+?(?=&)|(secret=)(.+)/i)[0].slice(7);if(null===a)ee("Could not parse the OTP secret. Please try manually entering the information.");else{var n=C.a.URI.parse(e);m(n.label||""),g(n.issuer||""),U(a),c(t||"totp"),x(n.algorithm||"SHA1"),N(n.digits||6),B(n.period||n.counter||30),Y(!1)}}else ee("OTP data not provided. Please try manually entering the information.")}}(e)},className:"camSection",id:"camSection"}),r.a.createElement("p",null,z)),r.a.createElement("div",{className:"otpFormWrapper",style:!1===Z?{display:"block"}:{display:"none"}},r.a.createElement(P,{algo:w,digits:k,issuer:v,name:i,period:W,secret:J,type:a,submit:function(e){var t,n,r,c;return u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.preventDefault(),J){o.next=5;break}ee("No secret provided. Operation not performed."),o.next=24;break;case 5:if(v){o.next=9;break}ee("No issuer provided. Operate not performed."),o.next=24;break;case 9:if(i){o.next=13;break}ee("No label provided. Operation not performed."),o.next=24;break;case 13:return t=JSON.parse(localStorage.getItem("cryptoKey")),o.next=16,u.a.awrap(A(t,J));case 16:return n=o.sent,o.next=19,u.a.awrap(A(t,v));case 19:return r=o.sent,o.next=22,u.a.awrap(A(t,i));case 22:c=o.sent,f.a.post("https://ultraotp.com/api/doc/new",{issuer:{text:r.text,iv:r.iv},name:{text:c.text,iv:c.iv},secret:{text:n.text,iv:n.iv},type:a,algo:w,digits:k,period:W},{headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}}).then((function(e){e.data.success?V("/list"):ee(e.data.message)}));case 24:case"end":return o.stop()}}))},setIssuer:g,setName:m,setSecret:U,setType:c,setPeriod:B,setDigits:N,setAlgo:x})),r.a.createElement("div",{className:"EntryBtn btnExt"},r.a.createElement("button",{className:"CircleLink linkExt",onClick:function(){return Y(!Z)}},!1===Z?r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ffffff"},r.a.createElement("circle",{cx:"12",cy:"12",r:"3.2"}),r.a.createElement("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})):r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ffffff"},r.a.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),r.a.createElement("span",{className:"CircleSpan spanExt spanSmall"},!1===Z?" SCAN":" FORM"))))},B=a(41);var F=function(e){var t=Object(n.useState)(!0),a=Object(p.a)(t,2),c=a[0],o=a[1];return Object(B.useScrollPosition)((function(e){var t=e.prevPos,a=e.currPos,n=a.y>t.y&&a.y>-40;n!==c&&o(n)}),[c],null,!1,300),r.a.createElement("div",{className:"EntryBtn "+(c?"btnExt":"")},r.a.createElement(l.b,{className:"CircleLink "+(c?"linkExt":""),to:"/new"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"#ffffff"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),r.a.createElement("span",{className:"CircleSpan "+(c?"spanExt":"")}," CREATE")))};function H(e){return r.a.createElement("div",{className:"ToastOuter",style:e.vis?{opacity:"1",visibility:"visible",zIndex:1e3}:{opacity:"0",visibility:"hidden",zIndex:"-1"}},r.a.createElement("div",{className:"Toast"},r.a.createElement("span",null,e.message)))}var J=a(42),U=a(25);function L(e){var t=.075*e.index;return r.a.createElement("div",{className:"EditIconWrapper"},r.a.createElement("button",{className:"EditIconInner "+(e.click?"desktopEdit fade-in":""),style:e.click&&{animationDelay:"".concat(t,"s")},onClick:function(){e.click&&e.click()}},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))))}var M=a(43),z=a(96),K=a(97),R=Object(M.a)({colorPrimary:{backgroundColor:"#eeeeee"},barColorPrimary:{backgroundColor:"rgba(50, 232, 117, 0.5)"},root:{borderRadius:"10px"},bar:{borderRadius:"10px"}})(K.a),D=Object(z.a)((function(e){return{root:{marginTop:"2px",height:"2px",borderRadius:"10px"}}}));function G(e){var t=e.num,a=D();return r.a.createElement("div",{className:"lineContainer"},r.a.createElement(R,{variant:"determinate",className:a.root,value:t>=1?e.num/e.den*100:1}))}var V=new TextDecoder;var q=function(e,t,a){var n,r,c,o;return u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,u.a.awrap(T(e));case 2:return n=l.sent,r=Uint8Array.from(Object(m.a)(t).map((function(e){return e.charCodeAt()}))),c=Uint8Array.from(Object(m.a)(a).map((function(e){return e.charCodeAt()}))),l.next=7,u.a.awrap(window.crypto.subtle.decrypt({name:"AES-GCM",iv:c},n,r));case 7:return o=l.sent,l.abrupt("return",V.decode(o));case 9:case"end":return l.stop()}}))};function _(e,t){return("totp"===e.type?new C.a.TOTP({algorithm:e.algo,digits:e.digits,period:e.period,secret:t}):new C.a.HOTP({algorithm:e.algo,digits:e.digits,counter:e.period,secret:t})).generate()}a(82);function Z(e){var t=.075*e.index;return r.a.createElement("div",{className:"Token fade-in",onClick:function(){return e.copy(e.code)},style:{animationDelay:"".concat(t,"s")}},r.a.createElement("div",{className:"tokenInfo"},r.a.createElement("p",{className:"tIssuer"},e.issuer),r.a.createElement("p",{className:"tLabel"},e.name)),r.a.createElement("div",{className:"tokenCode"},r.a.createElement("h2",null,e.code),e.timeRemaining>=0&&r.a.createElement(G,{num:e.timeRemaining,den:e.period})))}var Y=function(e){var t=e.token,a="totp"===t.type?e.seconds:null,c=Object(n.useState)(null),o=Object(p.a)(c,2),l=o[0],i=o[1],m=Object(n.useState)(null),d=Object(p.a)(m,2),f=d[0],h=d[1],v=Object(n.useState)(null),g=Object(p.a)(v,2),E=g[0],b=g[1],y=Object(n.useState)(null),w=Object(p.a)(y,2),x=w[0],O=w[1],S=Object(n.useState)(null),k=Object(p.a)(S,2),j=k[0],N=k[1],C=Object(n.useState)(null),T=Object(p.a)(C,2),I=T[0],A=T[1];Object(n.useEffect)((function(){var e,a,n=JSON.parse(localStorage.getItem("cryptoKey"));"totp"===t.type&&A((e=Date.now(),(a=t.period)-Math.floor(e/1e3)%a)),function(){var e,a,r;u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,u.a.awrap(q(n,t.secret.text,t.secret.iv));case 2:return e=c.sent,c.next=5,u.a.awrap(q(n,t.issuer.text,t.issuer.iv));case 5:return a=c.sent,c.next=8,u.a.awrap(q(n,t.name.text,t.name.iv));case 8:r=c.sent,b(_(t,e)),O(e),N(a),h(r);case 13:case"end":return c.stop()}}))}()}),[t]),Object(n.useEffect)((function(){a&&A((function(e){return e-1}))}),[a]),Object(n.useEffect)((function(){if(x&&I<=1){var e=_(t,x);e!==E&&(b(e),A(t.period))}}),[I,t,x,E]);var P=function(t){navigator.vibrate(3),navigator.clipboard.writeText(t).then((function(){return e.complete()}))};return l?r.a.createElement(s.a,{push:!0,to:"/edit/".concat(l)}):x&&j&&f?J.isMobile?r.a.createElement(U.SwipeableList,{swipeStartThreshold:10,threshold:.3},r.a.createElement(U.SwipeableListItem,{swipeLeft:{content:r.a.createElement(L,{click:null,index:e.index}),action:function(){return navigator.vibrate([5,60,5]),void setTimeout((function(){i(t.id)}),120)}}},r.a.createElement(Z,{copy:P,issuer:j,name:f,period:t.period,code:E,timeRemaining:I}))):r.a.createElement("div",{className:"desktopTokenWrapper"},r.a.createElement(Z,{copy:P,issuer:j,name:f,period:t.period,code:E,timeRemaining:I,index:e.index}),r.a.createElement(L,{click:function(){return i(t.id)},index:e.index})):r.a.createElement("div",null)};var Q=function(){var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),l=Object(p.a)(o,2),i=l[0],u=l[1],m=Object(n.useState)(""),d=Object(p.a)(m,2),h=d[0],v=d[1],g=Object(n.useState)(!1),E=Object(p.a)(g,2),y=E[0],w=E[1],x=Object(n.useState)(0),O=Object(p.a)(x,2),S=O[0],k=O[1];return Object(n.useEffect)((function(){var e=0,t=setInterval((function(){e++,k(e)}),1e3);return function(){clearInterval(t)}}),[]),Object(n.useEffect)((function(){var e=localStorage.getItem("JWT"),t=localStorage.getItem("cryptoKey");e&&t?f.a.get("https://ultraotp.com/api/doc/tokens",{headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}}).then((function(e){e.data.success?(c(e.data.tokens),localStorage.setItem("lastUpdate",Date.now())):v(e.data.message)})):(localStorage.removeItem("JWT"),localStorage.removeItem("cryptoKey"),u("/"))}),[]),Object(n.useEffect)((function(){if(y)var e=setTimeout((function(){w(!1)}),2e3);return function(){clearTimeout(e)}}),[y]),i?r.a.createElement(s.a,{to:i}):r.a.createElement("div",null,r.a.createElement(b,{close:function(){return v("")},message:h}),r.a.createElement(H,{message:"Copied!",vis:y}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Ultra OTP"),r.a.createElement("button",{className:"primaryBtn logoutBtn redirectBtn",onClick:function(){return localStorage.removeItem("JWT"),localStorage.removeItem("cryptoKey"),void u("/")}},"Log Out")),r.a.createElement("ul",{className:"tokenList"},a.map((function(e,t){return r.a.createElement("li",{key:e.id},r.a.createElement(Y,{token:e,seconds:S,complete:function(){return w(!0)},index:t}))}))),r.a.createElement(F,null))};var $=function(){var e=localStorage.getItem("JWT"),t=localStorage.getItem("cryptoKey");return e&&t?r.a.createElement(s.a,{to:"/list"}):r.a.createElement("div",null,r.a.createElement("header",{className:"homeHeader"},r.a.createElement("div",{className:"homeTitles"},r.a.createElement("h1",null,"Ultra OTP")),r.a.createElement("nav",{className:"homeLinksWrapper"},r.a.createElement(l.b,{to:"/register",className:"primaryBtn alertBtn cancelBtn btnFlex"},"Register"),r.a.createElement(l.b,{to:"/login",className:"primaryBtn alertBtn"},"Sign In"))),r.a.createElement("main",null,r.a.createElement("section",{className:"introSection"},r.a.createElement("h2",null,"Open-Source Two-Factor Authenticator"),r.a.createElement("p",null,r.a.createElement("strong",null,"Conveniently and securely access one-time password tokens from any device."))),r.a.createElement("section",null,r.a.createElement("h2",null,"Ultra Flexible"),r.a.createElement("p",null,"Ultra OTP is capable of generating both HMAC-based (HOTP) and time-based (TOTP) one-time passwords and includes advanced configuration options."),r.a.createElement("ul",{className:"postHList"},r.a.createElement("li",null,"Access from any mobile or desktop browser"),r.a.createElement("li",null,"Install on your smartphone as a standalone Progressive Web App"),r.a.createElement("li",null,r.a.createElement("a",{href:"https://addons.mozilla.org/en-US/firefox/addon/ultra-otp/",target:"_blank",rel:"noopener noreferrer"},"Firefox")," and ",r.a.createElement("a",{href:"https://chrome.google.com/webstore/detail/ultra-otp/hckclmddjnfcbcmoebpmlhhjafdgjnbe",target:"_blank",rel:"noopener noreferrer"},"Chrome")," extensions available"))),r.a.createElement("section",null,r.a.createElement("h2",null,"Ultra Secure"),r.a.createElement("p",null,r.a.createElement("strong",null,"Zero sensitive information ever leaves your device before being encrypted."),r.a.createElement("br",null),"The ",r.a.createElement("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto",target:"_blank",rel:"noopener noreferrer"},"Web Crypto API")," is utilized by your computer/phone to encrypt your data before it is sent to the server."),r.a.createElement("h3",null,"Saving Tokens"),r.a.createElement("p",null,"When you store a new OTP token, Ultra OTP derives a 256-bit AES encryption key from your master password using the PBKDF2 key derivation function. This key is used to encrypt OTP token data (issuer, account, secret); the encrypted data is finally sent from your device over a secure TLS connection to a cloud database for storage."),r.a.createElement("h3",null,"Accessing Tokens"),r.a.createElement("p",null,"When you log in to Ultra OTP your tokens are transmitted from the database to your device, then decrypted with your master password."),r.a.createElement("h3",null,"Logging In"),r.a.createElement("p",null,"You may notice that your master password is used for both logging in and encryption. In theory I, or an attacker, could secretly log your password when it is sent to the server and use it to decrypt your data."),r.a.createElement("p",null,"To prevent again such an attack, Ultra OTP salts and hashes your master password with your username on your device before it is transmitted to the server. Once the server receives the hashed password, it is salted again with a cryptographically secure random value, hashed again, and stored in a secure database. This process is repeated and hashes are compared every time you log in. The hashing functions that are used are one way hashes--they cannot be reverse engineered to reveal your true master password."),r.a.createElement("h3",null,"Is anything ",r.a.createElement("em",null,"not")," encrypted?"),r.a.createElement("p",{className:"preListP"},"Yes. A handful of fields are not encrypted for functionality and/or performance purposes:"),r.a.createElement("ul",{className:"postPList"},r.a.createElement("li",null,"Username"),r.a.createElement("li",null,"The following OTP token fields (with potential values listed):",r.a.createElement("ul",null,r.a.createElement("li",null,"Algorithm: SHA1, SHA256, SHA512"),r.a.createElement("li",null,"Digits: 6, 8"),r.a.createElement("li",null,"Time period: 30, 60"),r.a.createElement("li",null,"Type: HOTP, TOTP"))))),r.a.createElement("section",null,r.a.createElement("h2",null,"Ultra Private"),r.a.createElement("p",{className:"preListP"},"Ultra OTP is built from the ground up to ensure user privacy and security."),r.a.createElement("ul",{className:"postPList"},r.a.createElement("li",null,"No personal information is needed to create an account"),r.a.createElement("li",null,"Zero client-side analytics or tracking tools are in place"),r.a.createElement("li",null,"WhO dOeSn'T lOvE CoOkIeS? Me! Zero 3rd party cookies")))),r.a.createElement("footer",null,r.a.createElement("a",{href:"mailto:thomas@thomasg.dev"},"Contact me"),r.a.createElement("a",{href:"https://github.com/tggir1/ultraotp",target:"_blank",rel:"noopener noreferrer"},"View code on GitHub")))};function X(){var e=Object(s.g)().id,t=Object(n.useState)(null),a=Object(p.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(""),i=Object(p.a)(l,2),m=i[0],d=i[1],h=Object(n.useState)(!1),v=Object(p.a)(h,2),g=v[0],E=v[1],y=Object(n.useState)(""),w=Object(p.a)(y,2),x=w[0],O=w[1],S=Object(n.useState)(""),k=Object(p.a)(S,2),j=k[0],N=k[1],C=Object(n.useState)(""),T=Object(p.a)(C,2),I=T[0],W=T[1],B=Object(n.useState)(""),F=Object(p.a)(B,2),H=F[0],J=F[1],U=Object(n.useState)(""),L=Object(p.a)(U,2),M=L[0],z=L[1],K=Object(n.useState)(""),R=Object(p.a)(K,2),D=R[0],G=R[1],V=Object(n.useState)(""),_=Object(p.a)(V,2),Z=_[0],Y=_[1];Object(n.useEffect)((function(){localStorage.getItem("JWT")&&localStorage.getItem("JWT")?f.a.get("https://ultraotp.com/api/doc/token/".concat(e),{headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}}).then((function(e){if(e.data.success){var t=e.data.token;!function(e,t,a,n){var r,c,o;u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,u.a.awrap(q(e,t.text,t.iv));case 2:return r=l.sent,l.next=5,u.a.awrap(q(e,a.text,a.iv));case 5:return c=l.sent,l.next=8,u.a.awrap(q(e,n.text,n.iv));case 8:o=l.sent,J(r),N(c),G(o);case 12:case"end":return l.stop()}}))}(JSON.parse(localStorage.getItem("cryptoKey")),t.secret,t.issuer,t.name),O(t.digits),W(t.period),z(t.type),Y(t.algo),E(!0)}else d(e.data.message)})):o(!0)}),[e]);return c||!e?r.a.createElement(s.a,{to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:m,close:function(){return d("")}}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Edit"),r.a.createElement("div",{className:"homeLinksWrapper linkFlexRight"},r.a.createElement("button",{className:"primaryBtn alertBtn cancelBtn btnFlex",onClick:function(){return o(!0)}},"Cancel"),r.a.createElement("button",{className:"primaryBtn logoutBtn",onClick:function(){window.confirm("Are you sure you want to delete this token?")&&f.a.post("https://ultraotp.com/api/doc/delete/".concat(e),null,{headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}}).then((function(e){e.data.success?o(!0):d(e.data.message)}))}},"Delete Token"))),r.a.createElement("div",{className:"otpFormWrapper",style:g?{display:"block"}:{display:"none"}},r.a.createElement(P,{algo:Z,digits:x,issuer:j,name:D,period:I,secret:H,type:M,submit:function(t){var a,n,r,c;return u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(t.preventDefault(),H){l.next=5;break}d("No secret provided. Operation not performed."),l.next=24;break;case 5:if(j){l.next=9;break}d("No issuer provided. Operate not performed."),l.next=24;break;case 9:if(D){l.next=13;break}d("No label provided. Operation not performed."),l.next=24;break;case 13:return a=JSON.parse(localStorage.getItem("cryptoKey")),l.next=16,u.a.awrap(A(a,H));case 16:return n=l.sent,l.next=19,u.a.awrap(A(a,j));case 19:return r=l.sent,l.next=22,u.a.awrap(A(a,D));case 22:c=l.sent,f.a.post("https://ultraotp.com/api/doc/update/".concat(e),{digits:x,period:I,type:M,algo:Z,issuer:{text:r.text,iv:r.iv},name:{text:c.text,iv:c.iv},secret:{text:n.text,iv:n.iv}},{headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}}).then((function(e){e.data.success?o(!0):d(e.data.message)}));case 24:case"end":return l.stop()}}))},setIssuer:N,setName:G,setSecret:J,setType:z,setPeriod:W,setDigits:O,setAlgo:Y})))}var ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function te(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement((function(){return r.a.createElement(l.a,null,r.a.createElement("div",{className:"Wrapper"},r.a.createElement("div",{className:"App"},r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/login"}," ",r.a.createElement(O,null)," "),r.a.createElement(s.b,{path:"/register"}," ",r.a.createElement(S,null)," "),r.a.createElement(s.b,{path:"/new"}," ",r.a.createElement(W,null)," "),r.a.createElement(s.b,{path:"/list"}," ",r.a.createElement(Q,null)),r.a.createElement(s.b,{path:"/edit/:id"}," ",r.a.createElement(X,null)," "),r.a.createElement(s.b,{path:"/"},r.a.createElement($,null))))))}),null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ee?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):te(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):te(t,e)}))}}()}},[[45,1,2]]]);
//# sourceMappingURL=main.3e90a9e0.chunk.js.map