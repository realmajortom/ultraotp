(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{34:function(e,t,a){e.exports=a(69)},39:function(e,t,a){},40:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(27),c=a.n(l),s=(a(39),a(1)),o=a(5),i=a(9),m=(a(40),a(11)),u=a.n(m),p=u.a.create({baseURL:"http://192.168.1.111:8080/api/user"}),d={zIndex:10,position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.7)"},E={zIndex:11,position:"fixed",top:0,left:0,width:"100vw",height:"100vh",display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center"},f={zIndex:12,width:"calc(96% - 40px)",maxWidth:"460px",padding:"10px 20px",backgroundColor:"#ffffff",borderRadius:"10px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},v={width:"100%",display:"flex",justifyContent:"flex-end"},b=function(e){var t=e.message;return r.a.createElement("div",{className:"Alert",style:t.length>0?{display:"block"}:{display:"none"}},r.a.createElement("div",{style:d}),r.a.createElement("div",{style:E},r.a.createElement("div",{style:f},r.a.createElement("h2",null,"Message"),r.a.createElement("p",null,t),r.a.createElement("div",{style:v},r.a.createElement("button",{onClick:function(){return e.close()},className:"primaryBtn alertBtn"},"Ok")))))};var h=function(e){var t=Object(n.useContext)(M),a=Object(n.useState)(""),l=Object(s.a)(a,2),c=l[0],o=l[1],m=Object(n.useState)(""),u=Object(s.a)(m,2),d=u[0],E=u[1],f=Object(n.useState)(!1),v=Object(s.a)(f,2),h=v[0],g=v[1],O=Object(n.useState)(""),y=Object(s.a)(O,2),j=y[0],S=y[1];return h||t?r.a.createElement(i.a,{push:!0,to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:j,close:function(){return S("")}}),r.a.createElement("h1",null,"Login"),r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{type:"text",id:"username",name:"username",value:c,autoComplete:"username",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",name:"password",value:d,autoComplete:"new-password",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return E(e.target.value)}})),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(t){return function(t){t.preventDefault(),p.post("/login",{username:c,password:d}).then((function(t){t.data.success?(localStorage.setItem("JWT",t.data.JWT),e.setJwt(t.data.JWT),g(!0)):S(t.data.message)}))}(t)},value:"Sign In"})))};var g=function(e){var t=Object(n.useContext)(M),a=Object(n.useState)(""),l=Object(s.a)(a,2),c=l[0],o=l[1],m=Object(n.useState)(""),u=Object(s.a)(m,2),d=u[0],E=u[1],f=Object(n.useState)(!1),v=Object(s.a)(f,2),h=v[0],g=v[1],O=Object(n.useState)(""),y=Object(s.a)(O,2),j=y[0],S=y[1];return h||t?r.a.createElement(i.a,{push:!0,to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:j,close:function(){return S("")}}),r.a.createElement("h1",null,"Register"),r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"username"},"Create a Username ",r.a.createElement("span",null,"(4 - 120 chars.)")),r.a.createElement("input",{type:"text",id:"username",name:"username",value:c,autoComplete:"username",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"password"},"Create a Password ",r.a.createElement("span",null,"(4 - 120 chars.)")),r.a.createElement("input",{type:"password",id:"password",name:"password",value:d,autoComplete:"new-password",spellCheck:!1,required:!0,className:"primaryInput",onChange:function(e){return E(e.target.value)}})),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(t){return function(t){t.preventDefault(),p.post("/register",{username:c,password:d}).then((function(t){if(t.data.success)localStorage.setItem("JWT",t.data.JWT),e.setJwt(t.data.JWT),g(!0);else if(t.data.info){var a=t.data.info.u.message+"\n"+t.data.info.p.message;S(a)}else S(t.data.message)}))}(t)},value:"Register"})))},O=a(30),y=a.n(O),j=a(13),S=a.n(j),w=u.a.create({baseURL:"http://192.168.1.111:8080/api/doc",headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}});function N(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(!1),i=Object(s.a)(o,2),m=i[0],u=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"entryForm"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"issuer"},"Issuer"),r.a.createElement("input",{type:"text",id:"issuer",name:"issuer",value:e.issuer,autoComplete:"off",required:!0,className:"primaryInput",onChange:function(t){return e.setIssuer(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"name"},"Label"),r.a.createElement("input",{type:"text",id:"name",name:"name",value:e.name,autoComplete:"off",className:"primaryInput",onChange:function(t){return e.setName(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"name"},"Secret"),r.a.createElement("input",{type:l?"text":"password",id:"secret",name:"secret",value:e.secret,autoComplete:"new-password",required:!0,className:"primaryInput",onChange:function(t){return e.setSecret(t.target.value)}}),r.a.createElement("div",{className:"checkContainer"},r.a.createElement("input",{type:"checkbox",id:"passCheck",name:"passCheck",onChange:function(){return c(!l)}}),r.a.createElement("label",{htmlFor:"passCheck"},"Show Secret"))),r.a.createElement("div",{style:m?{display:"flex"}:{display:"none"},className:"advContainer"},r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"type"},"Type"),r.a.createElement("select",{id:"type",name:"type",className:"primarySelect",onChange:function(t){return e.setType(t.target.value)},value:e.type},r.a.createElement("option",{value:"totp"},"TOTP"),r.a.createElement("option",{value:"hotp"},"HOTP"))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"period"},"hotp"===e.type?"Counter":"Period (in seconds)"," "),r.a.createElement("input",{type:"text",id:"period",name:"period",value:e.period,autoComplete:"off",className:"primaryInput",onChange:function(t){return e.setPeriod(t.target.value)}})),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"digits"},"Digits"),r.a.createElement("select",{id:"digits",name:"digits",className:"primarySelect",onChange:function(t){return e.setDigits(t.target.value)},value:e.digits},r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"8"},"8"))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("label",{htmlFor:"algo"},"Algorithm"),r.a.createElement("select",{id:"algo",name:"algo",className:"primarySelect",onChange:function(t){return e.setAlgo(t.target.value)},value:e.algo},r.a.createElement("option",{value:"SHA1"},"SHA1"),r.a.createElement("option",{value:"SHA256"},"SHA256"),r.a.createElement("option",{value:"SHA512"},"SHA512")))),r.a.createElement("div",{className:"formGroup"},r.a.createElement("button",{onClick:function(e){return function(e){e.preventDefault(),u(!m)}(e)},className:"advBtn"},m?"Hide":"More Options")),r.a.createElement("input",{type:"submit",className:"primaryBtn userBtn",onClick:function(t){return e.submit(t)},value:"Submit"})))}var C=function(){var e=Object(n.useState)("totp"),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(""),o=Object(s.a)(c,2),m=o[0],u=o[1],p=Object(n.useState)(""),d=Object(s.a)(p,2),E=d[0],f=d[1],v=Object(n.useState)("SHA1"),h=Object(s.a)(v,2),g=h[0],O=h[1],j=Object(n.useState)(6),C=Object(s.a)(j,2),k=C[0],x=C[1],T=Object(n.useState)(30),I=Object(s.a)(T,2),B=I[0],F=I[1],W=Object(n.useState)(""),A=Object(s.a)(W,2),H=A[0],J=A[1],P=Object(n.useState)("Scanning..."),L=Object(s.a)(P,2),M=L[0],z=L[1],D=Object(n.useState)(null),G=Object(s.a)(D,2),R=G[0],U=G[1],q=Object(n.useState)(null),V=Object(s.a)(q,2),_=V[0],Q=V[1],$=Object(n.useState)(""),K=Object(s.a)($,2),X=K[0],Y=K[1];return Object(n.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0}).then((function(){return Q(!0)})).catch((function(){Q(!1)}))}),[]),R?r.a.createElement(i.a,{push:!0,to:"/".concat(R)}):r.a.createElement("div",null,r.a.createElement(b,{close:function(){return Y("")},message:X}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Add New Token"),r.a.createElement("button",{className:"primaryBtn redirectBtn alertBtn cancelBtn",onClick:function(){return U("list")}},"Cancel")),_&&r.a.createElement("div",{className:"camWrapper",style:{display:"flex",flexFlow:"column nowrap",alignItems:"center",marginTop:"40px"}},r.a.createElement(y.a,{delay:500,facingMode:"environment",showViewFinder:!0,onError:function(){z("Camera access must be enabled to scan QR codes.")},onScan:function(e){return function(e){if(null!==e&&e.length>14){var t=e.slice(10,14);if("totp"===t||"hotp"===t){var a=e.match(/(?<=secret=).+?(?=&)|(?<=secret=)(.+)/i);if(null===a)Y("Could not parse the OTP secret. Please try manually entering the information.");else{var n=S.a.URI.parse(e);u(n.label||""),f(n.issuer||""),J(a[0]),l(t||"totp"),O(n.algorithm||"SHA1"),x(n.digits||6),F(n.period||n.counter||30),Q(!1)}}else Y("OTP data not provided. Please try manually entering the information.")}}(e)},style:{width:"90%",maxWidth:"400px"}}),r.a.createElement("p",null,M)),r.a.createElement("div",{className:"otpFormWrapper",style:!1===_?{display:"block"}:{display:"none"}},r.a.createElement(N,{algo:g,digits:k,issuer:E,name:m,period:B,secret:H,type:a,submit:function(e){e.preventDefault(),H?w.post("/new",{type:a,name:m,issuer:E,algo:g,digits:k,period:B,secret:H}).then((function(e){e.data.success?U("list"):Y(e.data.message)})):Y("No secret provided. Operation not performed.")},setIssuer:f,setName:u,setSecret:J,setType:l,setPeriod:F,setDigits:x,setAlgo:O})),r.a.createElement("div",{className:"CreateBtn btnExt"},r.a.createElement("button",{className:"CircleLink linkExt",onClick:function(){return Q(!_)}},!1===_?r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ffffff"},r.a.createElement("circle",{cx:"12",cy:"12",r:"3.2"}),r.a.createElement("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})):r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ffffff"},r.a.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),r.a.createElement("span",{className:"CircleSpan spanExt spanSmall"},!1===_?" SCAN":" FORM"))))},k=a(32);var x=function(e){var t=Object(n.useState)(!0),a=Object(s.a)(t,2),l=a[0],c=a[1];return Object(k.useScrollPosition)((function(e){var t=e.prevPos,a=e.currPos,n=a.y>t.y&&a.y>-40;n!==l&&c(n)}),[l],null,!1,300),r.a.createElement("div",{className:"EntryBtn "+(l?"btnExt":"")},r.a.createElement(o.b,{className:"CircleLink "+(l?"linkExt":""),to:"/new"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"#ffffff"}),r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"})),r.a.createElement("span",{className:"CircleSpan "+(l?"spanExt":"")}," CREATE")," "))};function T(e){return r.a.createElement("div",{className:"ToastOuter",style:e.vis?{opacity:"1",visibility:"visible"}:{opacity:"0",visibility:"hidden"}},r.a.createElement("div",{className:"Toast"},r.a.createElement("span",null,e.message)))}var I=a(33),B=function(e){return("totp"===e.type?new S.a.TOTP({algorithm:e.algo,digits:e.digits,period:e.period,secret:e.secret}):new S.a.HOTP({algorithm:e.algo,digits:e.digits,counter:e.period,secret:e.secret})).generate()},F=function(e,t){return t-function(e,t){return Math.floor(e/1e3)%t}(e,t)};var W=function(e){var t=e.token,a=Object(n.useState)(B(t)),l=Object(s.a)(a,2),c=l[0],o=l[1],m=Object(n.useState)(""),u=Object(s.a)(m,2),p=u[0],d=u[1],E=Object(n.useState)(null),f=Object(s.a)(E,2),v=f[0],b=f[1];return Object(n.useEffect)((function(){if("totp"===t.type){var e,a=F(Date.now(),t.period);d(a);var n=setInterval((function(){1===a?(a=t.period,e=B(t),o(e)):a-=1,d(a)}),1e3)}else d(null);return function(){clearInterval(n)}}),[t]),v?r.a.createElement(i.a,{push:!0,to:"/edit/".concat(v)}):r.a.createElement("div",{className:"Token",onClick:function(){navigator.clipboard.writeText(c).then((function(){return e.complete()}))},onDoubleClick:function(){return b(t._id)}},r.a.createElement("div",{className:"tokenInfo"},r.a.createElement("p",{className:"tIssuer"},t.issuer),r.a.createElement("p",{className:"tLabel"},t.name)),r.a.createElement("div",{className:"tokenCode"},r.a.createElement("h2",null,c),p&&r.a.createElement("div",{className:"lineContainer"},r.a.createElement(I.a,{percent:p/t.period*100,strokeWidth:1,strokeColor:"rgba(50, 232, 117, 0.4)",trailWidth:1,trailColor:"#eeeeee"}))))},A=u.a.create({baseURL:"http://192.168.1.111:8080/api/doc",headers:{Authorization:"JWT ".concat(localStorage.getItem("JWT"))}});var H=function(){var e=Object(n.useContext)(M),t=Object(n.useState)([]),a=Object(s.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(null),m=Object(s.a)(o,2),u=m[0],p=m[1],d=Object(n.useState)(""),E=Object(s.a)(d,2),f=E[0],v=E[1],h=Object(n.useState)(!1),g=Object(s.a)(h,2),O=g[0],y=g[1];return Object(n.useEffect)((function(){null!==!e&&A.get("/tokens").then((function(e){e.data.success?c(e.data.tokens):v(e.data.message)}))}),[e]),u?r.a.createElement(i.a,{to:u}):r.a.createElement("div",null,r.a.createElement(b,{close:function(){return v("")},message:f}),r.a.createElement(T,{message:"Copied!",vis:O}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Ultra OTP"),r.a.createElement("button",{className:"primaryBtn logoutBtn redirectBtn",onClick:function(){return localStorage.removeItem("JWT"),void p("/")}},"Log Out")),r.a.createElement("ul",{className:"tokenList"},l.map((function(e){return r.a.createElement("li",{key:e._id},r.a.createElement(W,{token:e,complete:function(){return y(!0),void setTimeout((function(){y(!1)}),2e3)}}))}))),r.a.createElement(x,null))};var J=function(){return localStorage.getItem("JWT")?r.a.createElement(i.a,{to:"/list"}):r.a.createElement("div",null,r.a.createElement("div",{className:"homeHeader"},r.a.createElement("div",{className:"homeTitles"},r.a.createElement("h1",null,"CrossFA"),r.a.createElement("h2",null,"Multi-device 2FA tool")),r.a.createElement("nav",{className:"homeLinksWrapper"},r.a.createElement(o.b,{to:"/register",className:"primaryBtn",id:"registerBtn"},"Register"),r.a.createElement(o.b,{to:"/login",className:"primaryBtn"},"Sign In"))))};function P(){var e=Object(i.g)().id,t=Object(n.useState)(null),a=Object(s.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(""),m=Object(s.a)(o,2),u=m[0],p=m[1],d=Object(n.useState)(!1),E=Object(s.a)(d,2),f=E[0],v=E[1],h=Object(n.useState)(""),g=Object(s.a)(h,2),O=g[0],y=g[1],j=Object(n.useState)(""),S=Object(s.a)(j,2),C=S[0],k=S[1],x=Object(n.useState)(""),T=Object(s.a)(x,2),I=T[0],B=T[1],F=Object(n.useState)(""),W=Object(s.a)(F,2),A=W[0],H=W[1],J=Object(n.useState)(""),P=Object(s.a)(J,2),L=P[0],M=P[1],z=Object(n.useState)(""),D=Object(s.a)(z,2),G=D[0],R=D[1],U=Object(n.useState)(""),q=Object(s.a)(U,2),V=q[0],_=q[1];Object(n.useEffect)((function(){w.get("/token/".concat(e)).then((function(e){if(e.data.success){var t=e.data.token;y(t.digits),k(t.issuer),B(t.period),H(t.secret),M(t.type),R(t.name),_(t.algo),v(!0)}else p(e.data.message)}))}),[e]);return l||!e?r.a.createElement(i.a,{to:"/list"}):r.a.createElement("div",null,r.a.createElement(b,{message:u,close:function(){return p("")}}),r.a.createElement("div",{className:"homeHeader"},r.a.createElement("h1",null,"Edit"),r.a.createElement("div",{className:"homeLinksWrapper linkFlexRight"},r.a.createElement("button",{className:"primaryBtn alertBtn cancelBtn btnFlex",onClick:function(){return c(!0)}},"Cancel"),r.a.createElement("button",{className:"primaryBtn logoutBtn",onClick:function(){window.confirm("Are you sure you want to delete this token?")&&w.post("/delete/".concat(e)).then((function(e){e.data.success?c(!0):p(e.data.message)}))}},"Delete Token"))),r.a.createElement("div",{className:"otpFormWrapper",style:f?{display:"block"}:{display:"none"}},r.a.createElement(N,{algo:V,digits:O,issuer:C,name:G,period:I,secret:A,type:L,submit:function(t){t.preventDefault(),w.post("/update/".concat(e),{digits:O,issuer:C,period:I,secret:A,type:L,name:G,algo:V}).then((function(e){e.data.success?c(!0):p(e.data.message)}))},setIssuer:k,setName:R,setSecret:H,setType:M,setPeriod:B,setDigits:y,setAlgo:_})))}var L=r.a.createContext(localStorage.getItem("JWT"));function M(){var e=Object(n.useState)(localStorage.getItem("JWT")),t=Object(s.a)(e,2),a=t[0],l=t[1];return r.a.createElement(o.a,null,r.a.createElement(L.Provider,{value:a},r.a.createElement("div",{className:"Wrapper"},r.a.createElement("div",{className:"App"},r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login"}," ",r.a.createElement(h,{setJwt:l})," "),r.a.createElement(i.b,{path:"/register"}," ",r.a.createElement(g,{setJwt:l})," "),r.a.createElement(i.b,{path:"/new"}," ",r.a.createElement(C,null)," "),r.a.createElement(i.b,{path:"/list"}," ",r.a.createElement(H,null)),r.a.createElement(i.b,{path:"/edit/:id"}," ",r.a.createElement(P,null)," "),r.a.createElement(i.b,{path:"/"},r.a.createElement(J,null)))))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[34,1,2]]]);
//# sourceMappingURL=main.4ab695ea.chunk.js.map